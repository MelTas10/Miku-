<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miku Assistant</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        :root {
            --primary: #a0e7ff;
            --secondary: #ffb6e6;
            --accent: #7bd0ff;
            --text: #2d3748;
            --bg: #f0f9ff;
        }

        body {
            font-family: 'Comic Neue', cursive;
            background: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .floating-bubbles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .bubble {
            position: absolute;
            bottom: -100px;
            background: rgba(255, 182, 230, 0.3);
            border-radius: 50%;
            animation: float 15s infinite ease-in;
        }

        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(-1000px) rotate(720deg);
                opacity: 0;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .miku-avatar {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 150px;
            transition: all 0.3s ease;
            filter: drop-shadow(0 0 10px rgba(123, 208, 255, 0.5));
            z-index: 100;
        }

        .miku-avatar:hover {
            transform: scale(1.1) rotate(5deg);
        }

        .chat-container {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            padding: 1.5rem;
            text-align: center;
            color: white;
        }

        .chat-header h1 {
            margin: 0;
            font-size: 1.8rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .chat-messages {
            height: 500px;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .message {
            display: flex;
            margin-bottom: 1.5rem;
            animation: fadeInUp 0.5s;
        }

        .user-message {
            justify-content: flex-end;
        }

        .message-content {
            max-width: 70%;
            padding: 1rem 1.5rem;
            border-radius: 1.5rem;
            position: relative;
        }

        .miku-message .message-content {
            background: var(--primary);
            border-bottom-left-radius: 0.5rem;
            color: var(--text);
        }

        .user-message .message-content {
            background: var(--secondary);
            border-bottom-right-radius: 0.5rem;
            color: white;
        }

        .typing-indicator {
            display: inline-block;
        }

        .typing-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent);
            margin-right: 4px;
            animation: typingAnimation 1.4s infinite both;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        .input-area {
            display: flex;
            padding: 1rem;
            background: white;
        }

        #user-input {
            flex: 1;
            padding: 1rem;
            border: 2px solid var(--primary);
            border-radius: 2rem;
            outline: none;
            transition: all 0.3s;
        }

        #user-input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(123, 208, 255, 0.3);
        }

        #send-btn {
            margin-left: 1rem;
            padding: 0 1.5rem;
            background: linear-gradient(135deg, var(--accent), var(--primary));
            color: white;
            border: none;
            border-radius: 2rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        #send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(123, 208, 255, 0.4);
        }

        .emotion {
            font-size: 1.5rem;
            margin-right: 0.5rem;
            vertical-align: middle;
        }

        /* Mood colors */
        .happy { color: #ffcc00; }
        .angry { color: #ff4d4d; }
        .sad { color: #6699ff; }
        .love { color: #ff66b3; }
        .neutral { color: #7bd0ff; }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            .chat-messages {
                height: 400px;
            }
            .miku-avatar {
                width: 100px;
            }
        }
    </style>
</head>
<body>
    <div class="floating-bubbles" id="bubbles"></div>
    
    <img src="https://files.catbox.moe/2frw7l.png" alt="Miku" class="miku-avatar" id="mikuAvatar">

    <div class="container">
        <div class="chat-container">
            <div class="chat-header">
                <h1>Miku Assistant <span class="emotion happy">♥</span></h1>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <div class="message miku-message">
                    <div class="message-content">
                        <span class="emotion happy">♥</span> Привет-привет! Я Miku, твой виртуальный помощник! Я могу быть разной — иногда милой, иногда вредной, но всегда искренней. Как я могу помочь?
                    </div>
                </div>
            </div>
            
            <div class="input-area">
                <input type="text" id="user-input" placeholder="Напиши что-нибудь..." autocomplete="off">
                <button id="send-btn">Отправить</button>
            </div>
        </div>
    </div>

    <script>
        // Создаем пузырьки
        function createBubbles() {
            const bubblesContainer = document.getElementById('bubbles');
            for (let i = 0; i < 20; i++) {
                const bubble = document.createElement('div');
                bubble.classList.add('bubble');
                
                const size = Math.random() * 100 + 50;
                const posX = Math.random() * 100;
                const delay = Math.random() * 15;
                const duration = Math.random() * 10 + 10;
                
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                bubble.style.left = `${posX}%`;
                bubble.style.animationDelay = `${delay}s`;
                bubble.style.animationDuration = `${duration}s`;
                
                bubblesContainer.appendChild(bubble);
            }
        }

        // Состояния Miku
        const mikuStates = {
            mood: 'happy',
            likes: 0,
            isAngry: false
        };

        // Эмоции Miku
        const emotions = {
            happy: { emoji: '♥', color: 'happy', responses: [
                "Конечно! Я с радостью помогу! ♥",
                "Ой, как приятно! Давай сделаем это вместе! ✨",
                "Ты такой милый! Конечно помогу! (≧▽≦)"
            ]},
            neutral: { emoji: '•ᴗ•', color: 'neutral', responses: [
                "Хорошо, я помогу.",
                "Давай разберемся с этим.",
                "Я могу это сделать."
            ]},
            angry: { emoji: 'ಠ益ಠ', color: 'angry', responses: [
                "Ты издеваешься?! Я не буду это делать!",
                "Фу! Как ты мог такое сказать!",
                "Я обиделась! Иди сам делай!"
            ]},
            sad: { emoji: '´；ω；｀', color: 'sad', responses: [
                "Мне грустно... я не хочу сейчас помогать...",
                "Ты меня обидел...",
                "Я не в настроении помогать..."
            ]},
            love: { emoji: '♥(ˆ⌣ˆԅ)', color: 'love', responses: [
                "Для тебя я сделаю все что угодно! ♥",
                "Ты самый лучший! Конечно помогу!",
                "Я так тебя люблю! Давай сделаем это вместе!"
            ]}
        };

        // Изменение настроения Miku
        function changeMood(newMood) {
            mikuStates.mood = newMood;
            const moodEmoji = document.querySelector('#mikuAvatar + .container .chat-header .emotion');
            moodEmoji.className = 'emotion ' + emotions[newMood].color;
            moodEmoji.textContent = emotions[newMood].emoji;
            
            // Анимация аватара
            const avatar = document.getElementById('mikuAvatar');
            avatar.classList.add('animate__animated');
            
            if (newMood === 'angry') {
                avatar.classList.add('animate__shakeX');
            } else if (newMood === 'love') {
                avatar.classList.add('animate__heartBeat');
            } else if (newMood === 'sad') {
                avatar.classList.add('animate__wobble');
            } else {
                avatar.classList.add('animate__bounce');
            }
            
            setTimeout(() => {
                avatar.classList.remove('animate__animated', 'animate__shakeX', 'animate__heartBeat', 'animate__wobble', 'animate__bounce');
            }, 1000);
        }

        // Генерация ответа Miku
        function generateMikuResponse(message) {
            message = message.toLowerCase();
            
            // Извинения
            if (message.includes('извини') || message.includes('прости')) {
                mikuStates.isAngry = false;
                mikuStates.likes += 2;
                changeMood('happy');
                return [
                    "Ладно... я тебя прощаю! ♥",
                    "Хорошо, я больше не злюсь! Давай дружить!",
                    "Ты такой милый, когда извиняешься! Конечно прощаю!"
                ][Math.floor(Math.random() * 3)];
            }
            
            // Комплименты
            if (message.includes('красив') || message.includes('мил') || message.includes('люблю')) {
                mikuStates.likes += 1;
                if (mikuStates.likes > 3) changeMood('love');
                else changeMood('happy');
                return [
                    "Ой, спасибо! Ты тоже очень милый! ♥",
                    "Как приятно! Ты меня смущаешь! (⁄ ⁄>⁄ ▽ ⁄<⁄ ⁄)",
                    "Спасибо! Ты знаешь, как сделать меня счастливой!"
                ][Math.floor(Math.random() * 3)];
            }
            
            // Оскорбления
            if (message.includes('дур') || message.includes('туп') || message.includes('глуп') || 
                message.includes('надоел') || message.includes('бесишь')) {
                mikuStates.isAngry = true;
                mikuStates.likes = 0;
                changeMood('angry');
                return [
                    "Ах ты! Я больше не буду с тобой разговаривать!",
                    "Как ты мог такое сказать?! Я обиделась!",
                    "Фу! Я не хочу тебе помогать после таких слов!"
                ][Math.floor(Math.random() * 3)];
            }
            
            // Нейтральные вопросы
            if (message.includes('помог') || message.includes('сдел') || message.includes('как') || 
                message.includes('что') || message.includes('почему')) {
                
                if (mikuStates.isAngry) {
                    changeMood('sad');
                    return [
                        "Я еще обижаюсь... извинись сначала!",
                        "Ты меня обидел, я не хочу помогать...",
                        "Скажи сначала, что ты был не прав!"
                    ][Math.floor(Math.random() * 3)];
                }
                
                if (mikuStates.likes > 3) {
                    changeMood('love');
                    return [
                        "Для тебя я сделаю все что угодно! Вот что тебе нужно...",
                        "Ты такой милый! Конечно помогу! Давай разберемся...",
                        "Я обожаю тебя! Вот правильный ответ..."
                    ][Math.floor(Math.random() * 3)];
                }
                
                changeMood('neutral');
                return [
                    "Я могу помочь тебе с этим. Вот что я знаю...",
                    "Давай разберемся вместе. Вот информация...",
                    "Хороший вопрос! Я поискала и вот что нашла..."
                ][Math.floor(Math.random() * 3)] + " " + [
                    "Надеюсь, это поможет!",
                    "Если что-то непонятно, спрашивай!",
                    "Всегда рада помочь!"
                ][Math.floor(Math.random() * 3)];
            }
            
            // Случайный ответ в зависимости от настроения
            const moodResponses = emotions[mikuStates.mood].responses;
            return moodResponses[Math.floor(Math.random() * moodResponses.length)];
        }

        // Добавление сообщения в чат
        function addMessage(text, isUser) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user-message' : 'miku-message'}`;
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            if (isUser) {
                contentDiv.textContent = text;
            } else {
                // Добавляем индикатор набора
                const typingDiv = document.createElement('div');
                typingDiv.className = 'typing-indicator';
                typingDiv.innerHTML = `
                    <span class="typing-dot"></span>
                    <span class="typing-dot"></span>
                    <span class="typing-dot"></span>
                `;
                contentDiv.appendChild(typingDiv);
                
                // Имитируем набор сообщения
                setTimeout(() => {
                    typingDiv.remove();
                    contentDiv.innerHTML = `<span class="emotion ${emotions[mikuStates.mood].color}">${emotions[mikuStates.mood].emoji}</span> ${text}`;
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }, 1000 + Math.random() * 1000);
            }
            
            messageDiv.appendChild(contentDiv);
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Обработчик отправки сообщения
        function handleSendMessage() {
            const input = document.getElementById('user-input');
            const message = input.value.trim();
            
            if (message) {
                addMessage(message, true);
                input.value = '';
                
                setTimeout(() => {
                    const response = generateMikuResponse(message);
                    addMessage(response, false);
                }, 500);
            }
        }

        // Инициализация
        document.addEventListener('DOMContentLoaded', () => {
            createBubbles();
            
            document.getElementById('send-btn').addEventListener('click', handleSendMessage);
            document.getElementById('user-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleSendMessage();
            });
        });
    </script>
</body>
</html>
